<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>BG Player</title>
    <style>
      body{font-family:Segoe UI, Tahoma, sans-serif;margin:12px}
      .controls{display:flex;gap:8px;align-items:center}
      button{padding:8px 12px;border-radius:6px;border:none;background:#16a34a;color:#fff}
    </style>
  </head>
  <body>
    <div>
      <div style="font-weight:600;margin-bottom:8px">Nhạc nền (player nền)</div>
      <audio id="bg-audio" src="/sound/background_music.mp3" preload="auto" loop></audio>
      <div class="controls">
        <button id="play-btn">Play</button>
        <button id="pause-btn">Pause</button>
        <button id="close-btn" style="background:#dc2626">Đóng</button>
      </div>
      <p style="margin-top:8px;font-size:13px;color:#444">Gợi ý: cửa sổ này có thể bị trình duyệt chặn popup; nếu bị chặn, bật nhạc sẽ không hoạt động.</p>
    </div>

    <script>
      const audio = document.getElementById('bg-audio');
      const playBtn = document.getElementById('play-btn');
      const pauseBtn = document.getElementById('pause-btn');
      const closeBtn = document.getElementById('close-btn');

      playBtn.addEventListener('click', async () => {
        try { await audio.play(); } catch (e) { console.debug('play blocked', e); }
      });
      pauseBtn.addEventListener('click', () => { audio.pause(); });
      closeBtn.addEventListener('click', () => { window.close(); });

      // Auto-play if opened by user toggle
      (async () => {
        try { await audio.play(); } catch (e) { /* ignore */ }
      })();

      // Keep window name for reuse
      window.addEventListener('unload', () => {
        try { localStorage.setItem('bgPlayerClosed', 'true'); } catch (e) {}
      });
    </script>
  </body>
</html>